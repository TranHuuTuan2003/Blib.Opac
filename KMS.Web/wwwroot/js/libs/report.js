var Report=function(){return{DrawReportHeader:function(i,t){var e='<div class="header_report">';e+='<div class="item_1">';for(let t=0;t<i.length;t++)"organization"==i[t].type&&i[t].is_active&&(e=(e+='   <div id="div_'+i[t].id+'" class="text-center '+i[t].css_class+'" style="'+i[t].css_style+'" >')+'       <span id="span_'+i[t].id+'">'+i[t].data+"</span>   </div>");for(let t=0;t<i.length;t++)"department"==i[t].type&&i[t].is_active&&(e=(e+='   <div id="div_'+i[t].id+'" class="text-center '+i[t].css_class+'" style="'+i[t].css_style+'" >')+'       <span id="span_'+i[t].id+'">'+i[t].data+"</span>   </div>");e+='</div><div class="item_2">';for(let t=0;t<i.length;t++)"chxh"==i[t].type&&i[t].is_active&&(e=(e+='   <div id="div_'+i[t].id+'" class="text-center '+i[t].css_class+'" style="'+i[t].css_style+'" >')+'       <span id="span_'+i[t].id+'">'+i[t].data+"</span>   </div>");for(let t=0;t<i.length;t++)"dltd"==i[t].type&&i[t].is_active&&(e=(e+='<div id="div_'+i[t].id+'" class="text-center '+i[t].css_class+'" style="'+i[t].css_style+'" >')+'   <span id="span_'+i[t].id+'">'+i[t].data+"</span></div>");e+='</div><div class="item_3">';for(let t=0;t<i.length;t++)"title"==i[t].type&&i[t].is_active&&(e=(e+='<div id="div_'+i[t].id+'" class="text-center '+i[t].css_class+'" style="'+i[t].css_style+'" >')+'   <span id="span_'+i[t].id+'">'+i[t].data+"</span></div>");for(let t=0;t<i.length;t++)"sub_title"==i[t].type&&i[t].is_active&&(e=(e+='<div id="div_'+i[t].id+'" class="text-center '+i[t].css_class+'" style="'+i[t].css_style+'" >')+'   <span id="span_'+i[t].id+'">'+i[t].data+"</span></div>");return e=e+"   </div>"+"</div>"},DrawReportFooter:function(e,a){var i,s,n,l=(l="")+'   <div class="fw-bold">'+"   \t<div>";for(let i=0;i<e.length;i++)if("total"==e[i].group_type&&e[i].is_active)if("count"==e[i].type){var d=a.length;l+='   \t\t<span style="'+e[i].css_style+'">'+e[i].data+' <span id="'+e[i].type+'">'+d.toLocaleString()+"</span></span>"}else{d=0;for(let t=0;t<a.length;t++)a[t][e[i].data_field]&&(d+=parseInt(String(a[t][e[i].data_field]).replace(/,/g,""),10));l+='   \t\t<span style="'+e[i].css_style+'">'+e[i].data+' <span id="'+e[i].type+'" class="text-end">'+d.toLocaleString()+"</span></span>"}l+="   \t</div>";for(let i=0;i<e.length;i++)if("total_by_text"==e[i].group_type&&e[i].is_active){var o=0;for(let t=0;t<a.length;t++)a[t][e[i].data_field]&&(o+=parseInt(String(a[t][e[i].data_field]).replace(/,/g,""),10));l=(l+="   \t<div>")+('   \t\t<span style="'+e[i].css_style+'">'+e[i].data+' <span id="'+e[i].type+'">'+numberToWords(o)+"</span> đồng</span>")+"   \t</div>"}l+='   </div><div class="footer_report">    <div class="item_5">';for(let t=0;t<e.length;t++)"signer_left"==e[t].type&&e[t].is_active&&(l=(l+='   <div id="div_'+e[t].id+'" class="text-center '+e[t].css_class+'" style="'+e[t].css_style+'" >')+'       <span id="span_'+e[t].id+'">'+e[t].data+"</span>   </div>");l+='   </div>   <div class="item_6">';for(let t=0;t<e.length;t++)"signer_inner"==e[t].type&&e[t].is_active&&(l=(l+='   <div id="div_'+e[t].id+'" class="text-center '+e[t].css_class+'" style="'+e[t].css_style+'" >')+'       <span id="span_'+e[t].id+'">'+e[t].data+"</span>   </div>");l+='   </div>   <div class="item_7">';for(let t=0;t<e.length;t++)"date_month_year"==e[t].type&&e[t].is_active&&(l=(l+='   <div id="div_'+e[t].id+'" class="text-center '+e[t].css_class+'" style="'+e[t].css_style+'" >')+'       <span id="span_'+e[t].id+'">'+e[t].data+", "+(i=n=s=i=void 0,i=new Date,s=i.getDate(),n=i.getMonth()+1,i=i.getFullYear(),`ngày ${s=s<10?"0"+s:s} tháng ${n=n<10?"0"+n:n} năm `)+i+"</span>   </div>");for(let t=0;t<e.length;t++)"reporter"==e[t].type&&e[t].is_active&&(l=(l+='   <div id="div_'+e[t].id+'" class="text-center '+e[t].css_class+'" style="'+e[t].css_style+'" >')+'       <span id="span_'+e[t].id+'">'+e[t].data+"</span>   </div>");return l=l+"   </div>"+"</div>"},DrawReportTable1:function(e,a){a.length;var s,n,l,d,o=(o=(o="")+'<div class="table_report">'+'   <table class="table table-bordered mb-0" style="table-layout: fixed;">')+"       <thead>"+'           <tr class="text-center align-middle fw-bold">';for(let t=0;t<e.length;t++)"item"==e[t].group_type&&e[t].is_active&&(o+='               <th style="'+e[t].css_style+'">'+e[t].title_col+"</th>");o+="           </tr>       </thead>       <tbody>";for(let i=0;i<a.length;i++){console.log(a[i]),o+='           <tr id="s_tr_'+i+'" class="text-center align-middle fw-bold">';for(let t=0;t<e.length;t++)"item"==e[t].group_type&&e[t].is_active&&(s=e[t].data_field,n=e[t].css_class,l=e[t].css_style,e[t].data_type,d=e[t].type,""==s?o+='               <td class="fw-normal"></td>':s.toLowerCase().includes("#")?o+='               <td class="fw-normal '+n+'">'+(i+1)+"</td>":o+="number"==d?'               <td style="'+l+'" class="fw-normal '+n+'"><div style="display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp: 2;overflow: hidden;text-overflow: ellipsis;white-space: normal;">'+(a[i][s]=null===a[i][s]?"":a[i][s]).toLocaleString().replace(/,/g,".")+"</div></td>":'               <td style="'+l+'" class="fw-normal '+n+'"><div style="display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp: 2;overflow: hidden;text-overflow: ellipsis;white-space: normal;">'+(a[i][s]=null===a[i][s]?"":a[i][s])+"</div></td>");o+="           </tr>"}return o=o+"       </tbody>"+"   </table>"},DrawReportTable2:function(e,t,i){var a=(a=(a="")+'<div class="table_report">'+'   <table class="table table-bordered mb-0" style="table-layout: fixed; border-collapse: collapse;">')+"       <thead>"+'           <tr class="text-center align-middle fw-bold">';for(let i=0;i<e.length;i++)if(null==e[i].options||"no_header"==e[i].data_field)a+='               <th style="'+e[i].css_style+'">'+e[i].title+"</th>";else{a=(a=(a=(a+='<th style="'+e[i].css_style+'">')+('   <div class="text-center '+e[i].css_class+'" style="padding-top:3px;padding-bottom:3px;" >'))+('       <span style="">'+e[i].title+"</span>")+"   </div>")+('   <div class="text-center '+e[i].css_class+'" style="border-top: 1px solid black; margin-left:-3px; margin-right:-3px;display:flex;margin-bottom: -3px;" >');for(let t=0;t<e[i].options.length;t++)t==e[i].options.length-1?a+='   <div style="display: block; padding: 3px; '+e[i].options[t].css_style+'">':a+='   <div style="display: block; padding: 3px; border-right: 1px solid black;'+e[i].options[t].css_style+'">',a=a+("       <span>"+e[i].options[t].title)+"</span>   </div>";a=a+"   </div>"+"</th>"}return a=(a=(a=a+"           </tr>"+"       </thead>")+function(a,s,t){var n="";n+="       <tbody>";for(let e=0;e<s.length;e++){"RegisterSumary"==t&&e%5!=0?n+='           <tr style="border-bottom: 1px solid black" id="s_tr_'+e+'" class="text-center align-middle fw-bold">':n+='           <tr id="s_tr_'+e+'" class="text-center align-middle fw-bold">';for(let i=0;i<a.length;i++){var l=a[i].data_field,d=a[i].css_class,o=a[i].data_type,t=a[i].type;if("none"!=o||""!=o)if("options"in a[i]){n=n+('<td class="fw-normal '+d+'" style="white-space: normal;">')+'\t<div style="margin:-3px;display:flex;">';for(let t=0;t<a[i].options.length;t++){var r=a[i].options[t].data_field,c=a[i].options[t].css_class,p=a[i].options[t].css_style,r=s[e][r];n=(n+='   <div class="'+c+'" style="padding:3px;'+p+'">')+(null==r?"       <span>&nbsp;</span>":"       <span>"+r+"</span>")+"   </div>"}n=n+"   </div>"+"</td>"}else""==l?n+='               <td class="fw-normal"></td>':l.toLowerCase().includes("stt")?n+='               <td class="fw-normal '+d+'">'+(e+1)+"</td>":n+="number"==t?'               <td class="fw-normal '+d+'">'+(s[e][l]=null===s[e][l]?"":s[e][l]).toLocaleString().replace(/,/g,".")+"</td>":'               <td class="fw-normal '+d+'">'+(s[e][l]=null===s[e][l]?"":s[e][l])+"</td>"}n+="           </tr>"}return n+="       </tbody>"}(e,t,i))+"   </table>"+"</div>"},DrawReportCard:function(t,e,i){var a=t.reports,s=(s="")+('<tr id="s_tr_'+i+'" class="text-center align-middle" style="page-break-inside: avoid;">')+"    <td>";1<a.length?s+='<div style="display: flex; page-break-inside: avoid;">':s+='<div style="page-break-inside: avoid;">',s+="<style>"+t.css+"</style>";for(let i=0;i<a.length;i++){if(s+='<div style="'+t.style_div0+'">',0<a[i].text1.length)for(let t=0;t<a[i].text1.length;t++)s=(s=(s+='    <div style="'+a[i].text1[t].style_div1+'">')+'        <div style="'+a[i].text1[t].style_div2+'">')+"           <span>"+a[i].text1[t].text+"</span>        </div>    </div>";if(0<a[i].text2.length)for(let t=0;t<a[i].text2.length;t++)s=(s=(s+='    <div style="'+a[i].text2[t].style_div1+'">')+'        <div style="'+a[i].text2[t].style_div2+'">')+"           <span>"+a[i].text2[t].text1+"</span><span>"+a[i].text2[t].text2+"</span>        </div>    </div>";if(0<a[i].img.length)for(let t=0;t<a[i].img.length;t++)s=(s=(s+='    <div style="'+a[i].img[t].style_div1+'">')+'        <div style="'+a[i].img[t].style_div2+'">')+'           <img style="'+a[i].img[t].style_img+'" id="'+a[i].img[t].id+e+'" src="'+a[i].img[t].src+'">        </div>    </div>';if(0<a[i].line.length)for(let t=0;t<a[i].line.length;t++)s=s+('    <div style="'+a[i].line[t].style_div1)+'">    </div>';s+="</div>"}return s=(s+="    </div>")+"    </td>"+"</tr>"},DrawButton:function(i){var e="";for(let t=0;t<i.length;t++){var a=i[t].title,s=i[t].type,n=i[t].id,l=i[t].funct,d=i[t].className,o=i[t].icon;"button"==s?e+='<button id="'+n+'" type="'+s+'" class="btn '+d+'"> <i class="'+o+'"></i>'+a+"</button>":"a"==s&&(e+='<a id="'+n+'" '+l+' class="btn '+d+'"> <i class="'+o+'"></i>'+a+"</a>")}return e}}};function PrintCard(i,t){if("tvsl"==client_site){a=(a=(a="")+"<style>@media print { @page { size: auto; margin: 1cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact;}  #content_print {  display: grid; }}</style>"+'<div class="report_print_multi_card">')+'<table class="table table-bordered mb-0" style="table-layout: fixed; border-collapse: collapse;">'+"   <tbody>";for(let t=0;t<i.length;t++)null!=i[t].name&&null!=i[t].name||(i[t].name=""),null!=i[t].address&&null!=i[t].address||(i[t].address=""),null!=i[t].birth_date&&null!=i[t].birth_date||(i[t].birth_date=""),t%2==0&&(a+='       <tr style="border: none;">           <td style="padding: 0; border: none;">               <div style="display: flex;">'),a=(a=(a=(a=(a=(a=(a=(a=(a+='\t\t\t\t<div style="page-break-inside: avoid;width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid red; font-size:10px; margin-left: 30px; margin-bottom: 10px">\t\t\t\t\t<div style="position: absolute; margin-left: 2.8cm; margin-top:0.1cm">\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<img style= "width:1cm" src="../img/report/logo_tvsl.jpg">\t\t\t\t\t\t\t<span style="font-weight: 600;font-size: 14px;">THƯ VIỆN TỈNH SƠN LA</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 0.7cm;height: 1px;width: 4.2cm;background-color: black;margin-left: 3.9cm;border-bottom: 1px solid black"></div>\t\t\t\t\t<div style="position: absolute;margin-top: 1cm;margin-left: 4cm;">\t\t\t\t\t\t<span style="font-weight: 600;color: red;font-size: 18px;">THẺ THƯ VIỆN</span>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 0.5cm;margin-left: 0.3cm;width:2.3cm">\t\t\t\t\t\t<div>')+`							<img onerror="this.onerror=null; this.src='';" id="img_card_' + data[i].id + '" src="${i[t].avatar&&i[t].avatar}">`+'\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 4cm;margin-left: 0.1cm;width: 2.7cm;">\t\t\t\t\t\t<div style="text-align:center!important">')+'\t\t\t\t\t\t\t<img style="height: 0.6cm;width:auto;"  id="barcode_card'+i[t].id+'">\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 4.75cm;margin-left: 0.1cm;font-size: 12px;width: 2.7cm;word-wrap: break-word;line-height:0.8">')+'\t\t\t\t\t\t<div class="text-center"> <span style="">'+i[t].card_no+'</span></div>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 1.7cm;margin-left: 3.1cm; ">')+'\t\t\t\t\t\t<span>Số thẻ: </span><span  style="font-size: 12px;font-weight:700">'+i[t].card_no+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 2.1cm;margin-left: 3.1cm;">')+'\t\t\t\t\t\t<span>Họ và tên: </span><span style="font-size: 12px;">'+i[t].name+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 2.5cm;margin-left: 3.1cm;">')+'\t\t\t\t\t\t<span>Ngày sinh: </span><span style="font-size: 12px;">'+i[t].birth_date+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 2.9cm;margin-left: 3.1cm;width: 5.3cm;line-height:1.4; white-space: pre-line;">')+'\t\t\t\t\t\t<span>Địa chỉ: </span><span style="font-size: 12px;">'+i[t].address+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 4.3cm;margin-left: 3.7cm;">\t\t\t\t\t\t<div>')+'\t\t\t\t\t\t\t<span>HSD: </span><span style="font-size: 12px;">'+i[t].c_expire_date+'</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div style="position: absolute;margin-top: 4.7cm;margin-left: 3.7cm;font-size: 12px;">\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<span>https://thuviensonla.com.vn</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t</div>',t%2==1&&(a+="                </div>           </td>       </tr>");a=(a+="    </tbody>")+"</table>"+"</div>",$("#content_print").html(a);for(let t=0;t<i.length;t++){var e=removeVietnameseTones(i[t].card_no);JsBarcode("#barcode_card"+i[t].id,e,{format:"CODE39",lineColor:"#000",width:3,height:100,margin:0,displayValue:!1})}}if("default"==client_site){var a="";for(let t=0;t<i.length;t++)null!=i[t].name&&null!=i[t].name||(i[t].name=""),null!=i[t].address&&null!=i[t].address||(i[t].address=""),null!=i[t].birth_date&&null!=i[t].birth_date||(i[t].birth_date=""),a+="<style>@media print { @page { size: auto; margin: 1cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; }  #content_print {  display: grid;}}</style>",t%2==0&&(a+='       <tr style="border: none;">           <td style="padding: 0; border: none;">               <div style="display: flex;">'),a=(a=(a=(a=(a=(a=(a=(a=(a+='<div style="page-break-inside: avoid;width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid red; font-size:10px; margin-left: 30px; margin-bottom: 10px">\t<div class="library_name" style="position: absolute; margin-left: 2.7cm; margin-top:0.1cm">\t\t<div>\t\t\t<span style="font-weight: 600;font-size: 14px;">THƯ VIỆN QUỐC GIA VIỆT NAM</span>\t\t</div>\t</div>\t<div style="position: absolute;margin-top: 0.7cm;height: 1px;width: 4.2cm;background-color: black;margin-left: 3.56cm;border-bottom: 1px solid black">   \t</div>\t<div class="name_card" style="position: absolute;margin-top: 1cm;margin-left: 4cm;">\t\t<span style="font-weight: 600;color: red;font-size: 18px;">THẺ THƯ VIỆN</span>\t</div>\t<div class="image_card" style="position: absolute;margin-top: 0.5cm;margin-left: 0.3cm;width:2.3cm">\t\t<div>')+`			<img onerror="this.onerror=null; this.src='';" id="img_card_' + data[i].id + '" src="${i[t].avatar&&i[t].avatar}" />`+'\t\t</div>\t</div>\t<div class="card_barcode" style="position: absolute;margin-top: 4cm;margin-left: 0.1cm;width: 2.7cm;">\t\t<div style="text-align:center!important">')+'\t\t\t<img style="height: 0.6cm;width:auto;"  id="barcode_card'+i[t].id+'">\t\t</div>\t</div>\t<div style="position: absolute;margin-top: 4.75cm;margin-left: 0.1cm;font-size: 12px;width: 2.7cm;word-wrap: break-word;line-height:0.8">')+'\t\t<div class="text-center"> <span style="">'+i[t].card_no+'</span></div>\t</div>\t<div class="card_no" style="position: absolute;margin-top: 1.7cm;margin-left: 3.1cm; ">')+'\t\t<span>Số thẻ: </span><span  style="font-size: 12px;font-weight:700">'+i[t].card_no+'</span>\t</div>\t<div class="card_name" style="position: absolute;margin-top: 2.1cm;margin-left: 3.1cm;">')+'\t\t<span>Họ và tên: </span><span style="font-size: 12px;">'+i[t].name+'</span>\t</div>\t<div class="card_dob" style="position: absolute;margin-top: 2.5cm;margin-left: 3.1cm;">')+'\t\t<span>Ngày sinh: </span><span style="font-size: 12px;">'+i[t].birth_date+'</span>\t</div>\t<div class="card_address" style="position: absolute;margin-top: 2.9cm;margin-left: 3.1cm;width: 5.3cm;line-height:1.4;white-space: pre-line;">')+'\t\t<span>Địa chỉ: </span><span style="font-size: 12px;">'+i[t].address+'</span>\t</div>\t<div class="expire_date" style="position: absolute;margin-top: 4.3cm;margin-left: 3.7cm;">\t\t<div>')+'\t\t\t<span>HSD: </span><span style="font-size: 12px;">'+i[t].c_expire_date+'</span>\t\t</div>\t</div>\t<div class="url" style="position: absolute;margin-top: 4.7cm;margin-left: 3.7cm;font-size: 12px;">\t\t<div>\t\t\t<span>https://nlv.gov.vn</span>\t\t</div>\t</div></div>',t%2==1&&(a+="                </div>           </td>       </tr>");$("#content_print").html(a);for(let t=0;t<i.length;t++){e=removeVietnameseTones(i[t].card_no);JsBarcode("#barcode_card"+i[t].id,e,{format:"CODE39",lineColor:"#000",width:3,height:100,margin:0,displayValue:!1})}}if("tvyb"==client_site){var s="",n="";a=(a="")+"<style>@media print { @page { size: 17.32cm 29cm;margin: 0.8cm 0 0 0;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; }  #content_print {  display: grid;}}</style>"+'<div class="report_print_multi_card" >';for(let t=0;t<i.length;t++)null!=i[t].name&&null!=i[t].name||(i[t].name=""),null!=i[t].address&&null!=i[t].address||(i[t].address=""),null!=i[t].birth_date&&null!=i[t].birth_date||(i[t].birth_date=""),t%10==0&&(s='               <div style="break-before: page;">               \t   <div style="display: grid;grid-template-columns: 50% 50%;">',n='               <div style="break-before: page;"">               \t   <div style="display: grid;grid-template-columns: 50% 50%;">'),s=(s=(s=(s=(s=(s=(s=(s=(s+='\t\t\t\t<div style="width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin: 0.5mm;">\t\t\t\t\t<div class="library_name" style="position: absolute; margin-left: 2.5cm; margin-top:0.0cm">\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<span  style="font-weight: 600;font-size: 15px; font-family: \'Times New Roman\';">THƯ VIỆN TỈNH YÊN BÁI</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="name_card" style="position: absolute;margin-top: 0.5cm;margin-left: 3.2cm;">\t\t\t\t\t\t<span style="font-weight: 600;color: red;font-size: 18px;font-family: \'Times New Roman\';">THẺ BẠN ĐỌC</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="image_card" style="position: absolute;margin-top: 1.3cm;margin-left: 0.2cm;width:2.1cm; height: 2.8cm; border: 1px solid;">\t\t\t\t\t\t<div>')+`							<img onerror="this.onerror=null; this.src='';" id="img_card_' + data[i].id + '" src="`+i[t].avatar+'">\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_barcode" style="position: absolute;margin-top: 1.7cm;margin-left: 3.2cm;width: 2.7cm;">\t\t\t\t\t\t<div style="text-align:center!important">')+'\t\t\t\t\t\t\t<img style="height: 0.8cm;width:auto;"  id="barcode_card'+i[t].id.replace(/[^a-zA-Z0-9]/g,"")+'">\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_no" style="position: absolute;margin-top: 1.1cm;margin-left: 3.2cm; ">')+'\t\t\t\t\t\t<span>Số thẻ: </span><span  style="font-size: 15px;font-weight:700">'+i[t].card_no+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_name" style="position: absolute;margin-top: 2.6cm;margin-left: 2.5cm;">')+'\t\t\t\t\t\t<span>Họ và tên: </span><span style="font-size: 12px;">'+i[t].name+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_dob" style="position: absolute;margin-top: 3.0cm;margin-left: 2.5cm;">')+'\t\t\t\t\t\t<span>Năm sinh: </span><span style="font-size: 12px;">'+i[t].birth_date.match(/\b\d{4}\b/)[0]+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_address" style="position: absolute;margin-top: 3.5cm;margin-left: 2.5cm;line-height:1.4;font-size: 12px;">\t\t\t\t\t\t<div style="display: flex;">')+'\t\t\t\t\t\t\t<div>Địa chỉ: </div><div style="width: 4.7cm;overflow-wrap: break-word;white-space: normal;">'+i[t].address+"</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div>")+'\t\t\t\t\t\t\t<span>Ngày cấp thẻ: </span><span style="font-size: 12px;">'+i[t].c_issue_date+"</span>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div>")+'\t\t\t\t\t\t\t<span>Ngày hết hạn: </span><span style="font-size: 12px;">'+i[t].c_expire_date+"</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t</div>",n=(n+='\t\t\t\t\t<div style="width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin: 0.5mm;">\t\t\t<div class="" style="position: absolute;margin-left: 1.5cm;margin-top: 0.05cm;">')+"\t\t\t\t\t\t\t<div>"+`								<span style="font-weight: 600;font-size: 12px; font-family: 'Times New Roman';">QUY ĐỊNH SỬ DỤNG THẺ BẠN ĐỌC</span>`+'\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 0.5cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t<p style="text-indent: 15px;">1. Bạn đọc phải xuất trình thẻ khi đến sử dụng các dịch vụ của Thư viện tỉnh.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.2cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">2. Không được cho người khác mượn thẻ. Thẻ bị mất hoặc rách nát bạn đọc phải xin cấp lại thẻ.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.9cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">3. Bạn đọc được mượn sách về tương ứng với giá trị tiền cược sách theo giá bìa/1 lần mượn trong thời gian 15 ngày, nếu quá hạn phải xin gia hạn.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 2.95cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div><p style="text-indent: 15px;">4. Bạn đọc được mượn sách quá hạn 01 năm (kể từ ngày mượn), thư viện sẽ làm thủ tục thanh lý, dùng tiền cược mua sách khác mà không cần phải thông báo tới bạn đọc.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t\t<p style="text-indent: 15px;">5. Bạn đọc làm mất, hư hỏng... sách phải bồi thường theo quy định của thư viện.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4.75cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<p style="text-indent: 15px;">6. Thẻ bạn đọc có giá trị sử dụng trong 1 năm kể từ ngày cấp.\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>                \t</div>',t===i.length-1&&i.length%2==1&&(n=(n+='\t\t\t\t\t<div style="width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin: 0.5mm;">\t\t\t<div class="" style="position: absolute;margin-left: 1.5cm;margin-top: 0.05cm;">')+"\t\t\t\t\t\t\t<div>"+`								<span style="font-weight: 600;font-size: 12px; font-family: 'Times New Roman';">QUY ĐỊNH SỬ DỤNG THẺ BẠN ĐỌC</span>`+'\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 0.5cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t<p style="text-indent: 15px;">1. Bạn đọc phải xuất trình thẻ khi đến sử dụng các dịch vụ của Thư viện tỉnh.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.2cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">2. Không được cho người khác mượn thẻ. Thẻ bị mất hoặc rách nát bạn đọc phải xin cấp lại thẻ.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.9cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">3. Bạn đọc được mượn sách về tương ứng với giá trị tiền cược sách theo giá bìa/1 lần mượn trong thời gian 15 ngày, nếu quá hạn phải xin gia hạn.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 2.95cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div><p style="text-indent: 15px;">4. Bạn đọc được mượn sách quá hạn 01 năm (kể từ ngày mượn), thư viện sẽ làm thủ tục thanh lý, dùng tiền cược mua sách khác mà không cần phải thông báo tới bạn đọc.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t\t<p style="text-indent: 15px;">5. Bạn đọc làm mất, hư hỏng... sách phải bồi thường theo quy định của thư viện.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4.75cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<p style="text-indent: 15px;">6. Thẻ bạn đọc có giá trị sử dụng trong 1 năm kể từ ngày cấp.\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>                \t</div>'),t%10!=9&&t!==i.length-1||(a+=(s=s+"        </div>"+"        </div>")+(n=n+"       </div>"+"       </div>"));a+="</div>",$("#content_print").html(a);for(let t=0;t<i.length;t++){e=removeVietnameseTones(i[t].card_no);JsBarcode("#barcode_card"+i[t].id.replace(/[^a-zA-Z0-9]/g,""),e,{format:"CODE39",lineColor:"#000",width:3,height:100,margin:0,displayValue:!1})}}if("tvyb2"==client_site){a=(a=(a="")+"<style>@media print { @page { size: auto; margin: 1cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; }  #content_print {  display: grid;}}</style>"+'<div class="report_print_multi_card">')+'<table class="table table-bordered mb-0" style="table-layout: fixed; border-collapse: collapse;">'+"   <tbody>";for(let t=0;t<i.length;t++)null!=i[t].name&&null!=i[t].name||(i[t].name=""),null!=i[t].address&&null!=i[t].address||(i[t].address=""),null!=i[t].birth_date&&null!=i[t].birth_date||(i[t].birth_date=""),a=(a=(a=(a=(a=(a=(a=(a=(a=(a+='       <tr style="border: none;">           <td style="padding: 0; border: none;">               <div style="display: flex;">\t\t\t\t<div style="page-break-inside: avoid;width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin-left: 30px; margin-bottom: 10px">\t\t\t\t\t<div class="library_name" style="position: absolute; margin-left: 2.5cm; margin-top:0.0cm">\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<span  style="font-weight: 600;font-size: 15px; font-family: \'Times New Roman\';">THƯ VIỆN TỈNH YÊN BÁI</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="name_card" style="position: absolute;margin-top: 0.5cm;margin-left: 3.2cm;">\t\t\t\t\t\t<span style="font-weight: 600;color: red;font-size: 18px;font-family: \'Times New Roman\';">THẺ BẠN ĐỌC</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="image_card" style="position: absolute;margin-top: 1.3cm;margin-left: 0.2cm;width:2.1cm; height: 2.8cm; border: 1px solid;">\t\t\t\t\t\t<div>')+`							<img onerror="this.onerror=null; this.src='';" id="img_card_' + data[i].id + '" src="`+i[t].avatar+'">\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_barcode" style="position: absolute;margin-top: 1.7cm;margin-left: 3.2cm;width: 2.7cm;">\t\t\t\t\t\t<div style="text-align:center!important">')+'\t\t\t\t\t\t\t<img style="height: 0.8cm;width:auto;"  id="barcode_card'+i[t].id.replace(/[^a-zA-Z0-9]/g,"")+'">\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_no" style="position: absolute;margin-top: 1.1cm;margin-left: 3.2cm; ">')+'\t\t\t\t\t\t<span>Số thẻ: </span><span  style="font-size: 15px;font-weight:700">'+i[t].card_no+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_name" style="position: absolute;margin-top: 2.6cm;margin-left: 2.5cm;">')+'\t\t\t\t\t\t<span>Họ và tên: </span><span style="font-size: 12px;">'+i[t].name+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_dob" style="position: absolute;margin-top: 3.0cm;margin-left: 2.5cm;">')+'\t\t\t\t\t\t<span>Ngày sinh: </span><span style="font-size: 12px;">'+i[t].birth_date+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_address" style="position: absolute;margin-top: 3.5cm;margin-left: 2.5cm;line-height:1.4;display: flex;">')+'\t\t\t\t\t\t<div>Địa chỉ: </div><div style="font-size: 12px;width: 4.7cm;overflow-wrap: break-word;white-space: normal;">'+i[t].address+'</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="issue_date" style="position: absolute;margin-top: 4.4cm;margin-left: 2.5cm;">\t\t\t\t\t\t<div>')+'\t\t\t\t\t\t\t<span>Ngày cấp thẻ: </span><span style="font-size: 12px;">'+i[t].c_issue_date+'</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="expire_date" style="position: absolute;margin-top: 4.8cm;margin-left: 2.5cm;">\t\t\t\t\t\t<div>')+'\t\t\t\t\t\t\t<span>Ngày hết hạn: </span><span style="font-size: 12px;">'+i[t].c_expire_date+'</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t<div style="page-break-inside: avoid;width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin-bottom: 10px">\t\t\t\t\t  <div class="" style="position: absolute;margin-left: 1.5cm;margin-top: 0.05cm;">\t\t\t<div>')+`				<span style="font-weight: 600;font-size: 12px; font-family: 'Times New Roman';">QUY ĐỊNH SỬ DỤNG THẺ BẠN ĐỌC</span>`+'\t\t\t</div>\t\t</div>\t\t<div class="" style="position: absolute;margin-top: 0.5cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t<p style="text-indent: 15px;">1. Bạn đọc phải xuất trình thẻ khi đến sử dụng các dịch vụ của Thư viện tỉnh.</p>\t\t</div>\t\t<div class="" style="position: absolute;margin-top: 1.2cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t<p style="text-indent: 15px;">2. Không được cho người khác mượn thẻ. Thẻ bị mất hoặc rách nát bạn đọc phải xin cấp lại thẻ.</p>\t\t</div>\t\t<div class="" style="position: absolute;margin-top: 1.9cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t<p style="text-indent: 15px;">3. Bạn đọc được mượn sách về tương ứng với giá trị tiền cược sách theo giá bìa/1 lần mượn trong thời gian 15 ngày, nếu quá hạn phải xin gia hạn.</p>\t\t</div>\t\t<div class="" style="position: absolute;margin-top: 2.95cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t<div><p style="text-indent: 15px;">4. Bạn đọc được mượn sách quá hạn 01 năm (kể từ ngày mượn), thư viện sẽ làm thủ tục thanh lý, dùng tiền cược mua sách khác mà không cần phải thông báo tới bạn đọc.</p>\t\t\t</div>\t\t</div>\t\t<div class="" style="position: absolute;margin-top: 4cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t<div>\t\t\t\t<p style="text-indent: 15px;">5. Bạn đọc làm mất, hư hỏng... sách phải bồi thường theo quy định của thư viện.</p>\t\t\t</div>\t\t</div>\t\t<div class="" style="position: absolute;margin-top: 4.75cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t\t\t<div>\t\t\t\t<p style="text-indent: 15px;">6. Thẻ bạn đọc có giá trị sử dụng trong 1 năm kể từ ngày cấp.\t\t\t</p>\t\t</div>\t</div>            </div>                </div>           </td>       </tr>';a=(a+="    </tbody>")+"</table>"+"</div>",$("#content_print").html(a);for(let t=0;t<i.length;t++){e=removeVietnameseTones(i[t].card_no);JsBarcode("#barcode_card"+i[t].id.replace(/[^a-zA-Z0-9]/g,""),e,{format:"CODE39",lineColor:"#000",width:3,height:100,margin:0,displayValue:!1})}}if("tvftu"==client_site){s="",n="";a=(a="")+"<style>@media print { @page { size: 17.32cm 29cm; margin: 0;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; }  #content_print {  display: grid;}}</style>"+'<div class="report_print_multi_card" >';for(let t=0;t<i.length;t++)null!=i[t].name&&null!=i[t].name||(i[t].name=""),null!=i[t].address&&null!=i[t].address||(i[t].address=""),null!=i[t].birth_date&&null!=i[t].birth_date||(i[t].birth_date=""),t%10==0&&(s='               <div style="break-before: page;">               \t   <div style="display: grid;grid-template-columns: 50% 50%;">',n='               <div style="break-before: page;"">               \t   <div style="display: grid;grid-template-columns: 50% 50%;">'),s=(s=(s=(s=(s=(s=(s=(s=(s+='\t\t\t\t<div style="width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin: 0.5mm;">\t\t\t\t\t<div class="library_name" style="position: absolute; margin-left: 2.5cm; margin-top:0.0cm">\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<span  style="font-weight: 600;font-size: 15px; font-family: \'Times New Roman\';">THƯ VIỆN TRƯỜNG</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="name_card" style="position: absolute;margin-top: 0.5cm;margin-left: 3.2cm;">\t\t\t\t\t\t<span style="font-weight: 600;color: red;font-size: 18px;font-family: \'Times New Roman\';">THẺ BẠN ĐỌC</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="image_card" style="position: absolute;margin-top: 1.3cm;margin-left: 0.2cm;width:2.1cm; height: 2.8cm; border: 1px solid;">\t\t\t\t\t\t<div>')+`							<img onerror="this.onerror=null; this.src='';" id="img_card_' + data[i].id + '" src="`+i[t].avatar+'">\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_barcode" style="position: absolute;margin-top: 1.7cm;margin-left: 3.2cm;width: 2.7cm;">\t\t\t\t\t\t<div style="text-align:center!important">')+'\t\t\t\t\t\t\t<img style="height: 0.8cm;width:auto;"  id="barcode_card'+i[t].id.replace(/[^a-zA-Z0-9]/g,"")+'">\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_no" style="position: absolute;margin-top: 1.1cm;margin-left: 3.2cm; ">')+'\t\t\t\t\t\t<span>Số thẻ: </span><span  style="font-size: 15px;font-weight:700">'+i[t].card_no+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_name" style="position: absolute;margin-top: 2.6cm;margin-left: 2.5cm;">')+'\t\t\t\t\t\t<span>Họ và tên: </span><span style="font-size: 12px;">'+i[t].name+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_dob" style="position: absolute;margin-top: 3.0cm;margin-left: 2.5cm;">')+'\t\t\t\t\t\t<span>Ngày sinh: </span><span style="font-size: 12px;">'+i[t].birth_date+'</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="card_address" style="position: absolute;margin-top: 3.5cm;margin-left: 2.5cm;line-height:1.4;display: flex;">')+'\t\t\t\t\t\t<div>Địa chỉ: </div><div style="font-size: 12px;width: 4.7cm;overflow-wrap: break-word;white-space: normal;">'+i[t].address+'</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="issue_date" style="position: absolute;margin-top: 4.4cm;margin-left: 2.5cm;">\t\t\t\t\t\t<div>')+'\t\t\t\t\t\t\t<span>Ngày cấp thẻ: </span><span style="font-size: 12px;">'+i[t].c_issue_date+'</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="expire_date" style="position: absolute;margin-top: 4.8cm;margin-left: 2.5cm;">\t\t\t\t\t\t<div>')+'\t\t\t\t\t\t\t<span>Ngày hết hạn: </span><span style="font-size: 12px;">'+i[t].c_expire_date+"</span>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t</div>",n=(n+='\t\t\t\t\t<div style="width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin: 0.5mm;">\t\t\t<div class="" style="position: absolute;margin-left: 1.5cm;margin-top: 0.05cm;">')+"\t\t\t\t\t\t\t<div>"+`								<span style="font-weight: 600;font-size: 12px; font-family: 'Times New Roman';">QUY ĐỊNH SỬ DỤNG THẺ BẠN ĐỌC</span>`+'\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 0.5cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t<p style="text-indent: 15px;">1. Bạn đọc phải xuất trình thẻ khi đến sử dụng các dịch vụ của Thư viện tỉnh.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.2cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">2. Không được cho người khác mượn thẻ. Thẻ bị mất hoặc rách nát bạn đọc phải xin cấp lại thẻ.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.9cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">3. Bạn đọc được mượn sách về tương ứng với giá trị tiền cược sách theo giá bìa/1 lần mượn trong thời gian 15 ngày, nếu quá hạn phải xin gia hạn.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 2.95cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div><p style="text-indent: 15px;">4. Bạn đọc được mượn sách quá hạn 01 năm (kể từ ngày mượn), thư viện sẽ làm thủ tục thanh lý, dùng tiền cược mua sách khác mà không cần phải thông báo tới bạn đọc.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t\t<p style="text-indent: 15px;">5. Bạn đọc làm mất, hư hỏng... sách phải bồi thường theo quy định của thư viện.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4.75cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<p style="text-indent: 15px;">6. Thẻ bạn đọc có giá trị sử dụng trong 1 năm kể từ ngày cấp.\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>                \t</div>',t===i.length-1&&i.length%2==1&&(n=(n+='\t\t\t\t\t<div style="width:8.56cm;height: 5.4cm;background-color: white;border: 2px solid; font-size:13px; margin: 0.5mm;">\t\t\t<div class="" style="position: absolute;margin-left: 1.5cm;margin-top: 0.05cm;">')+"\t\t\t\t\t\t\t<div>"+`								<span style="font-weight: 600;font-size: 12px; font-family: 'Times New Roman';">QUY ĐỊNH SỬ DỤNG THẺ BẠN ĐỌC</span>`+'\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 0.5cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t<p style="text-indent: 15px;">1. Bạn đọc phải xuất trình thẻ khi đến sử dụng các dịch vụ của Thư viện tỉnh.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.2cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">2. Không được cho người khác mượn thẻ. Thẻ bị mất hoặc rách nát bạn đọc phải xin cấp lại thẻ.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 1.9cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<p style="text-indent: 15px;">3. Bạn đọc được mượn sách về tương ứng với giá trị tiền cược sách theo giá bìa/1 lần mượn trong thời gian 15 ngày, nếu quá hạn phải xin gia hạn.</p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 2.95cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div><p style="text-indent: 15px;">4. Bạn đọc được mượn sách quá hạn 01 năm (kể từ ngày mượn), thư viện sẽ làm thủ tục thanh lý, dùng tiền cược mua sách khác mà không cần phải thông báo tới bạn đọc.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t\t<p style="text-indent: 15px;">5. Bạn đọc làm mất, hư hỏng... sách phải bồi thường theo quy định của thư viện.</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="" style="position: absolute;margin-top: 4.75cm;line-height: 1.2;width: 8.2cm;overflow-wrap: break-word;white-space: normal;text-align: justify;font-size:10px;margin-left: 0.1cm;">\t\t\t\t\t\t\t\t\t<div>\t\t\t\t\t\t\t<p style="text-indent: 15px;">6. Thẻ bạn đọc có giá trị sử dụng trong 1 năm kể từ ngày cấp.\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>                \t</div>'),t%10!=9&&t!==i.length-1||(a+=(s=s+"        </div>"+"        </div>")+(n=n+"       </div>"+"       </div>"));a+="</div>",$("#content_print").html(a);for(let t=0;t<i.length;t++){e=removeVietnameseTones(i[t].card_no);JsBarcode("#barcode_card"+i[t].id.replace(/[^a-zA-Z0-9]/g,""),e,{format:"CODE39",lineColor:"#000",width:3,height:100,margin:0,displayValue:!1})}}}function CatalogCard(){var i=(i="")+"<style>@media print { @page { size: 25cm 16cm; margin: 0;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; }  #content_print {  display: grid;} }</style>"+'<div class="report_print_multi_card" >';for(let t=0;t<1;t++)i+='\t\t\t\t<div style="page-break-after: always;width:12.5cm;height: 7.5cm;background-color: white; font-size:17px;border: 2px solid;">\t\t\t\t\t<div class="author" style="position: absolute;margin-top: 0.8cm;margin-left: 2.5cm;">\t\t\t\t\t\t<span>HIDAKA BANRI</span>\t\t\t\t\t</div>\t\t\t\t\t<div class="isbd" style="position: absolute;margin-top: 1.5cm;margin-left: 2.5cm;width: 9.6cm;overflow-wrap: break-word;white-space: normal;text-align: justify;line-height:1.2;">\t\t\t\t\t\t<p style="text-indent: 1cm;">Thấy mờ ghét :  Truyện tranh / Hidaka Banri ; Hoa Ngiêm dịch. - Tp.Hồ Chí Minh : nXB. Trẻ. - 18cm. - (Truyện tranh dành cho Tuổi mới lớn)</p>\t\t\t\t\t\t<div style="text-indent: 1cm;">T.8. - 2008. - 198tr.</div>\t\t\t\t\t\t<div style="text-indent: 1cm;">15000 đ</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="MFN" style="position: absolute;margin-top: 5cm;margin-left: 1cm;">\t\t\t\t\t\t<div style="">MFN</div>\t\t\t\t\t\t<div style="">4725</div>\t\t\t\t\t</div>\t\t\t\t\t<div class="MFN" style="position: absolute;margin-top: 5cm;margin-left: 9cm;justify-content:center;">\t\t\t\t\t\t<div style="">741.5</div>\t\t\t\t\t\t<div style="">TH126M</div>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t<div style="page-break-after: always;width:12.5cm;height: 7.5cm;background-color: white; font-size:17px;border: 2px solid;">\t\t\t\t\t<div class="card_no" style="position: absolute;width: 9.9cm;margin-top: 1.5cm;margin-left: 2.5cm; ">\t\t\t\t\t\t<p style="text-indent: 1cm;">TN31525</p>\t\t\t\t\t</div>\t\t\t\t</div>';i+="\t\t\t\t</div>",$("#content_print").html(i)}function BTCReportDKCB(i){var e=(e="")+'<table style="">'+'<style>@media print { @page { size: auto; margin: 1cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; } #content_print {  display: grid;}}"</style>';for(let t=0;t<i.length;t++){var a="";i[t].class&&(a=i[t].class.substring(0,10)),t%6==0&&(e+='   <tr id="" class="text-center align-middle" style="page-break-inside: avoid;">      <td style="display:flex;">'),e=(e=(e=(e=(e=(e=(e=(e+='          <div class="text-center align-middle" style="height: 3.5cm; width: 2.7cm;margin: 2px;border: 2px black solid;">')+'              <div style="border-bottom: 2px black solid;">'+'                  <div style="font-size: 10px;font-weight: bold; ">THƯ VIỆN</div>')+'                  <div style="line-height: 105%;font-size: 10px;font-weight: bold;">TỈNH SƠN LA</div>'+"              </div>")+'              <div style="padding:12px 1px 3px 1px;">'+('                  <div style="line-height: 100%;font-size: 15px;font-weight: bold;">'+a+"</div>"))+('                  <div style="font-size: 15px;font-weight: bold;line-height: 100%;">'+i[t].cutter+"</div>")+'                  <div style="margin: 2px 0 2px 0">')+('                      <img style="height: 0.8cm" id="barcode_card_'+i[t].id+'">')+"                  </div>")+('                  <span style=" line-height: 100%;font-size: 20px;font-weight: bold;">'+i[t].id+"</span>"))+"              </div>"+"          </div>",t%6!=5&&t!=i.length-1||(e+="      </td>   </tr>")}e+="</table>",$("#content_print").html(e);for(let t=0;t<i.length;t++)JsBarcode("#barcode_card_"+i[t].id,i[t].id,{format:"CODE39",lineColor:"#000",width:2,height:100,margin:0,displayValue:!1})}function ADReportDKCB(i){if("tvyb"==client_site){s=(s="")+'<table style="table-layout: fixed;">'+'<style>@media print { @page { size: auto; margin: 1cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; } #content_print {  display: grid;}}"</style>';for(let t=0;t<i.length;t++){var e="",a="",a=(e=i[t].class?i[t].class.substring(0,18):e).length<=9?"23":e.length<=12&&9<e.length?"21":e.length<=14&&12<e.length?"19":e.length<=16&&14<e.length?"17":"15";t%4==0&&(s+='   <tr id="" class="text-center align-middle" style="page-break-inside: avoid;">      <td style="display:flex;">'),s=(s=(s=(s=(s=(s+='          <div class="text-center align-middle" style="height: 3cm; width: 4.2cm;margin: 0.05cm;border: 2px black solid;font-family: \'Arial\';">')+'              <div style="height: 2.8cm; width: 4cm;margin: 0.05cm;border: 2px black solid;">'+('                  <div style="position: absolute;line-height: 100%;font-size: '+a+'px;font-weight: bold;margin-top: 0.1cm;height: 0.5cm; width: 3.9cm;">'+e+"</div>"))+('                  <div style="position: absolute;font-size: 20px;font-weight: bold;line-height: 100%;height: 0.55cm; width: 3.9cm;margin-top: 0.7cm;">'+i[t].cutter+"</div>")+'                  <div style="position: absolute;margin-top: 1.3cm;width: 3.9cm;">')+('                      <img style="height: 0.8cm; max-width: 4.2cm;" id="barcode_card_'+t+'">')+"                  </div>")+('                  <div style="position: absolute;font-size: 17px;font-weight: bold;margin-top: 2.1cm;width: 3.9cm;">'+i[t].id+"</div>"))+"              </div>"+"          </div>",t%4!=3&&t!=i.length-1||(s+="      </td>   </tr>")}s+="</table>",$("#content_print").html(s);for(let t=0;t<i.length;t++)JsBarcode("#barcode_card_"+t,i[t].id,{format:"CODE39",lineColor:"#000",width:2,height:100,margin:0,displayValue:!1})}if("tvftu"==client_site){s=(s="")+'<table style="table-layout: fixed;">'+'<style>@media print { @page { size: auto; margin: 0.3cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; } #content_print {  display: grid;}}"</style>';for(let t=0;t<i.length;t++){e="";t%5==0&&(s+='   <tr id="" class="text-center align-middle" style="page-break-inside: avoid;">      <td style="display:flex;">'),s=(s=(s=s+'          <div class="text-center align-middle" style="height: 1.6cm; width: 3.9cm;margin: 0.05cm;border: 2px black solid;font-family: \'Arial\';">'+'               <div style="position: absolute;margin-top: 0.2cm;width: 3.8cm;">')+('                   <img style="height: 0.7cm; max-width: 3.8cm;" id="barcode_card_'+t+'">')+"               </div>")+('               <div style="position: absolute;font-size: 15px;font-weight: bold;margin-top: 0.9cm;width: 3.8cm;">'+i[t].id+"</div>")+"          </div>",t%5!=4&&t!=i.length-1||(s+="      </td>   </tr>")}s+="</table>",$("#content_print").html(s);for(let t=0;t<i.length;t++)JsBarcode("#barcode_card_"+t,i[t].id,{format:"CODE39",lineColor:"#000",width:2,height:100,margin:0,displayValue:!1})}else{var s;s=(s="")+'<table style="table-layout: fixed;">'+'<style>@media print { @page { size: auto; margin: 0.5cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; } #content_print {  display: grid;}}"</style>';for(let t=0;t<i.length;t++){e="";i[t].class&&(e=i[t].class.substring(0,10)),t%7==0&&(s+='   <tr id="" class="text-center align-middle" style="page-break-inside: avoid;">      <td style="display:flex;">'),s=(s=(s=(s=(s=(s=(s=(s+='          <div class="text-center align-middle" style="height: 3.5cm; width: 2.7cm;margin: 2px;border: 2px black solid;">')+'              <div style="border-bottom: 2px black solid;">'+'                  <div style="font-size: 10px;font-weight: bold; ">THƯ VIỆN</div>')+'                  <div style="line-height: 105%;font-size: 10px;font-weight: bold;">SỐ</div>'+"              </div>")+'              <div style="padding:12px 1px 3px 1px;">'+('                  <div style="line-height: 100%;font-size: 15px;font-weight: bold;">'+e+"</div>"))+('                  <div style="font-size: 15px;font-weight: bold;line-height: 100%;">'+i[t].cutter+"</div>")+'                  <div style="margin: 2px 0 2px 0">')+('                      <img style="height: 0.8cm" id="barcode_card_'+t+'">')+"                  </div>")+('                  <span style=" line-height: 100%;font-size: 20px;font-weight: bold;">'+i[t].id+"</span>"))+"              </div>"+"          </div>",t%7!=6&&t!=i.length-1||(s+="      </td>   </tr>")}s+="</table>",$("#content_print").html(s);for(let t=0;t<i.length;t++)JsBarcode("#barcode_card_"+t,i[t].id,{format:"CODE39",lineColor:"#000",width:2,height:100,margin:0,displayValue:!1})}}function ADReportDKCBNoClass(i){if("tvyb"==client_site){e=(e="")+'<table style="table-layout: fixed;">'+'<style>@media print { @page { size: auto; margin: 0.2cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; } #content_print {  display: grid;}}"</style>';for(let t=0;t<i.length;t++)i[t].class&&i[t].class.substring(0,10),t%5==0&&(e+='   <tr id="" class="text-center align-middle" style="page-break-inside: avoid;">      <td style="display:flex;">'),e=(e=(e=(e=(e=e+'          <div class="text-center align-middle" style="height: 2.5cm; width: 4cm;margin: 0.05cm;border: 2px black solid;">'+'              <div style="margin: 0.05cm;border: 2px black solid;">')+'                  <div style="line-height: 100%;font-size: 13px;margin-top: 0.1cm;height: 0.4cm; max-width: 3.7cm;">THƯ VIỆN YÊN BÁI</div>'+'                  <div style="margin: 2px 0 2px 0">')+('                      <img style="height: 0.8cm; max-width: 3.8cm;" id="barcode_card_'+t+'">')+"                  </div>")+("                  <div style=\"margin-top: 0.2cm;height: 0.64cm; line-height: 100%;font-size: 20px;font-weight: bold;max-width: 3.8cm;font-family: 'Arial';\">"+i[t].id+"</div>"))+"              </div>"+"          </div>",t%5!=4&&t!=i.length-1||(e+="      </td>   </tr>");e+="</table>",$("#content_print").html(e);for(let t=0;t<i.length;t++)JsBarcode("#barcode_card_"+t,i[t].id,{format:"CODE39",lineColor:"#000",width:2,height:100,margin:0,displayValue:!1})}else if("tvftu"==client_site){e=(e="")+'<style>@media print { @page { size: auto; margin: 1cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; } #content_print {  display: grid;}}"</style>'+'<table style="table-layout: fixed;">';for(let t=0;t<i.length;t++)t%5==0&&(e+='   <tr id="" class="text-center align-middle" style="page-break-inside: avoid;">      <td style="display:flex;">'),e=(e+='          <div class="text-center align-middle" style="height: 0.85cm; width: 3.5cm;margin: 0.05cm;border: 2px black solid;">')+"                  <div style=\"margin-top: -0.1cm;font-size: 24px;width: 3.4cm;font-family: 'Times New Roman';\">"+i[t].id+"</div>          </div>",t%5!=4&&t!=i.length-1||(e+="      </td>   </tr>");e+="</table>",$("#content_print").html(e)}else{var e;e=(e="")+'<table style="table-layout: fixed;">'+'<style>@media print { @page { size: auto; margin: 0.3cm;} body {-webkit-print-color-adjust: exact; print-color-adjust: exact; } #content_print {  display: grid;}}"</style>';for(let t=0;t<i.length;t++)i[t].class&&i[t].class.substring(0,10),t%5==0&&(e+='   <tr id="" class="text-center align-middle" style="page-break-inside: avoid;">      <td style="display:flex;">'),e=(e=(e=(e=(e=e+'          <div class="text-center align-middle" style="height: 2.5cm; width: 4cm;margin: 0.05cm;border: 2px black solid;">'+'              <div style="margin: 0.05cm;border: 2px black solid;">')+'                  <div style="line-height: 100%;font-size: 13px;margin-top: 0.1cm;height: 0.4cm; max-width: 3.7cm;">THƯ VIỆN SỐ</div>'+'                  <div style="margin: 2px 0 2px 0">')+('                      <img style="height: 0.8cm; max-width: 3.8cm;" id="barcode_card_'+t+'">')+"                  </div>")+("                  <div style=\"margin-top: 0.2cm;height: 0.64cm; line-height: 100%;font-size: 20px;font-weight: bold;max-width: 3.8cm;font-family: 'Arial';\">"+i[t].id+"</div>"))+"              </div>"+"          </div>",t%5!=4&&t!=i.length-1||(e+="      </td>   </tr>");e+="</table>",$("#content_print").html(e);for(let t=0;t<i.length;t++)JsBarcode("#barcode_card_"+t,i[t].id,{format:"CODE39",lineColor:"#000",width:2,height:100,margin:0,displayValue:!1})}}function DrawCouponBook(){html="",html=(html+='<div class="report_count_book fw-bold">')+'<table class="table table-bordered mb-0" style="table-layout: fixed; border-collapse: collapse;border: none;">   <tbody>';for(let t=0;t<5;t++){t%2==0&&(html=(html+='       <tr style="border: none;">')+'           <td style="padding: 0; border: none;">               <div style="display: flex;">'),html=(html=(html=(html=(html=(html=(html+='               <div style="padding:15px;border: 1px dashed #000;">')+'               \t<div style="width: 9.5cm;">'+'               \t    <div class="item_grid_header">')+'               \t        <div class=" text-start" style="width:100%">Số DKCB DVN.037192</div>'+'               \t        <div class=" text-start" style="width:100%">Tên sách: Quan niệm của C.Mác -Ph.</div>')+'               \t        <div style="display:flex">'+'               \t            <div class=" text-start" style="width:70%">Tập:...</div>')+'               \t            <div class=" text-start" style="width:30%">Giá:</div>'+"               \t        </div>")+"               \t    </div>"+'               \t    <table class="table" style="table-layout: fixed;">')+'               \t        <thead><tr style="height: 9mm;" class="fw-bold"><th>Ngày Mượn</th><th>Số thẻ ĐG</th><th>Chữ ký</th></tr></thead>'+"               \t        <tbody>";for(let t=0;t<14;t++)html+='               \t        \t<tr style="height: 9mm; border-bottom: 1px dashed #000;"><td></td><td></td><td></td></tr>';html=(html=html+"               \t        </tbody>"+"               \t    </table>")+"               \t</div>"+"                </div>",t%2==1&&(html=(html+="                </div>")+"           </td>       </tr>")}return html=(html+="    </tbody>")+"</table>"+"</div>"}function DrawCouponBookA5(i){html="",html=(html+='<div class="report_count_book fw-bold">')+'<table class="table table-bordered mb-0" style="table-layout: fixed; border-collapse: collapse;">   <tbody>';for(let t=0;t<i.length;t++){t%2==0&&(html=(html+="       <tr>")+'           <td style="padding: 0">               <div style="display: flex;page-break-inside: avoid; font-size:17px;">'),html=(html=(html=(html=(html=(html=(html=(html+='               <div style="padding:15px;border: 1px dashed #000;">')+'               \t<div style="width: 8.5cm;">'+'               \t    <div class="item_grid_header">')+('               \t        <div class=" text-start" style="width:100%">Số ĐKCB: '+i[t].id+"</div>"))+('               \t        <div class=" text-start" style="width:100%">Tên sách: '+shortenTitle(i[t].title,30)+"</div>"))+'               \t        <div style="display:flex">'+'               \t            <div class=" text-start" style="width:60%">Tập:...</div>')+('               \t            <div class=" text-start" style="width:40%">Giá: '+i[t].price+"</div>")+"               \t        </div>")+"               \t    </div>"+'               \t    <table class="table" style="table-layout: fixed;">')+'               \t        <thead class="text-center"><tr style="height: 7mm;" class="fw-bold"><th>Ngày Mượn</th><th>Số thẻ ĐG</th><th>Chữ ký</th></tr></thead>'+"               \t        <tbody>";for(let t=0;t<10;t++)html+='               \t        \t<tr style="height: 8mm; border-bottom: 1px dashed #000;"><td></td><td></td><td></td></tr>';html=(html=html+"               \t        </tbody>"+"               \t    </table>")+"               \t</div>"+"                </div>",t%2==1&&(html=(html+="                </div>")+"           </td>       </tr>")}return html=(html+="    </tbody>")+"</table>"+"</div>"}const groupBy=(t,s)=>{t=t.reduce((i,e)=>{const a=s.map(t=>e[t]).join("-");return i[a]||(i[a]={keys:{},values:[]},s.forEach(t=>i[a].keys[t]=e[t])),i[a].values.push(e),i},{});return Object.entries(t).map(([,t])=>({keys:t.keys,values:t.values}))};function truncateString(t,i){if(t.length<=i)return t;let e=t.slice(0,i);return(e=" "!==t[i]&&" "!==t[i-1]?e.slice(0,e.lastIndexOf(" ")):e)+"..."}function ChangeTotalReport(e){var a=[],i=1;if($('input[name="checkboxdata"]:checked').each(function(){a.push($(this).attr("id"))}),0<a.length){for(let t=0;t<a.length;t++)$("#s_"+a[t]+" td:first").text(i),i++;for(let i=0;i<e.length;i++){if("total_1"==e[i].type||"total_2"==e[i].type){var t=0;for(let t=0;t<a.length;t++){var s=parseInt($("#s_"+a[t]+" td:nth-child("+getAlphabetIndex(e[i].show_location)+")").text().replace(/[^\d]/g,""));isNaN(s)||(totalPrice+=s)}$("#"+e[i].type).text(t.toLocaleString().replace(/,/g,"."))}if("count"==e[i].type&&(t=a.length,$("#"+e[i].type).text(t.toLocaleString())),"total_txt_1"==e[i].type||"total_txt_2"==e[i].type){var n=0;for(let t=0;t<a.length;t++){s=parseFloat($("#s_"+a[t]+" td:nth-child("+getAlphabetIndex(e[i].show_location)+")").text().replace(/,/g,"").trim());isNaN(s)||(n+=s)}$("#"+e[i].type).text(numberToWords(n))}}}}function ChangeTotalReportV2(e){var t,a=[],i=1;if($('input[name="checkboxdata"]:checked').each(function(){a.push($(this).attr("id"))}),0<a.length&&null!=e){for(let t=0;t<a.length;t++)$("#s_"+a[t]+" td:first").text(i),i++;for(let i=0;i<e.length;i++){if("totalPrice"==e[i].id){var s=0;for(let t=0;t<a.length;t++){var n=parseFloat($("#s_"+a[t]+" td:nth-child("+e[i].value+")").text().replace(/,/g,"").trim());isNaN(n)||(s+=n)}$("#totalPrice").text(s.toLocaleString()),$("#totalPriceTxt").text(numberToWords(s))}if("total"==e[i].id&&(t=a.length,$("#total").text(t)),"totalBook"==e[i].id){var l=0;for(let t=0;t<a.length;t++){n=parseFloat($("#s_"+a[t]+" td:nth-child("+e[i].value+")").text().replace(/,/g,"").trim());isNaN(n)||(l+=n)}$("#totalBook").text(l)}}}}function ClientCheckAll(t,i){for(var e=document.getElementsByName(i),a=document.getElementById(t).checked,s=0;s<e.length;s++)e[s].checked=a;DisplayRowInTable()}function DisplayRowInTable(){var t=[];$('input[name="checkboxdata"]:checked').each(function(){t.push($(this).attr("id"))}),0===t.length?$("#content_print tbody tr").show():($("#content_print tbody tr").hide(),t.forEach(function(t){$("#content_print tbody #s_"+t).show()}))}function numberToWords(t){var i=["","nghìn","triệu","tỷ","nghìn tỷ"];const s=["không","một","hai","ba","bốn","năm","sáu","bảy","tám","chín"];if(0===t)return"không";let e="",a=0;for(;0<t;){var n=t%1e3;0<n&&(e=(t=>{let i="";var e=Math.floor(t/100),a=Math.floor(t%100/10),t=t%10;return 0<e&&(i+=s[e]+" trăm "),1<a?i+=s[a]+" mươi ":1===a&&(i+="mười "),0<t&&(i+=s[t]),i.trim()})(n)+" "+i[a]+" "+e),t=Math.floor(t/1e3),a++}return e.trim()}function truncate15Words(t,i){var e;return null!=t?(e=t.split(" ")).length>i?e.slice(0,i).join(" ")+"...":t:""}function removeVietnameseTones(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/À|Á|Ạ|Ả|Ã|Â|Ầ|Ấ|Ậ|Ẩ|Ẫ|Ă|Ằ|Ắ|Ặ|Ẳ|Ẵ/g,"A")).replace(/È|É|Ẹ|Ẻ|Ẽ|Ê|Ề|Ế|Ệ|Ể|Ễ/g,"E")).replace(/Ì|Í|Ị|Ỉ|Ĩ/g,"I")).replace(/Ò|Ó|Ọ|Ỏ|Õ|Ô|Ồ|Ố|Ộ|Ổ|Ỗ|Ơ|Ờ|Ớ|Ợ|Ở|Ỡ/g,"O")).replace(/Ù|Ú|Ụ|Ủ|Ũ|Ư|Ừ|Ứ|Ự|Ử|Ữ/g,"U")).replace(/Ỳ|Ý|Ỵ|Ỷ|Ỹ/g,"Y")).replace(/Đ/g,"D")).replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g,"")).replace(/\u02C6|\u0306|\u031B/g,"")}function shortenTitle(t,i=28){if(t.length<=i)return t;let e=t.slice(0,i);return e=t[i]&&" "!==t[i]&&" "!==e[i-1]&&-1!==(t=e.lastIndexOf(" "))?e.slice(0,t):e}function getAlphabetIndex(t){return t.charAt(0).toUpperCase().charCodeAt(0)-64}