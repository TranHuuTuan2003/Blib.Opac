@using KMS.Shared.DTOs.Document
@using KMS.Web.Common
@using KMS.Web.ViewModels.Shared.Components.DocumentDetail
@model DocumentDetailViewModel
@using KMS.Web.Helpers

@{
	var baseUrlImage = AppConfigHelper.GetBaseUrlFile();
}


<div class="library-container__content-row">
	<div class="second-content__library-container">
		<label class="library-container__title">
			Tài liệu liên quan
			<span class="library-container__line"></span>
		</label>
		<div class="library-layout-two-columns">
			<!-- Cột trái: Danh sách thư viện -->
			<div class="library-container__library-list">
				@foreach (var item in Model.RelatedDocuments)
				{
					var thumb = !string.IsNullOrWhiteSpace(item.cover_photo) ? (baseUrlImage + item.cover_photo) : null;
					var defaultImage = ConstLocation.value + "/img/" + DefaultCoverPhoto.GetImageForBibType(item.bib_type ?? "");

					<div class="library-container__card-detail-book">
						<img src="@(thumb ?? defaultImage)"
							 alt="@item.title" />

						<div class="library-container__content-detail-book">
							<h2 class="library-container__blue-text-detail-book truncate-2-lines" onclick="window.open('@ConstLocation.value/chi-tiet-tai-lieu/@item.slug','_blank')" style="cursor:grabbing">
								@item.title
							</h2>

							<div class="line-and-text">
								<div class="vertical-line"></div>
								<h1 class="library-container__gray-text-light-detail-book library-container__small-text-detail-book">
									@item.bib_type
								</h1>
							</div>

							<p class="truncate-1-lines">
								Tác giả: <span style="color: var(--secondary-color);">@item.item_ext.author</span>
							</p>
							<p class="truncate-1-lines">
								Thông tin xuất bản: <b style="font-weight:600">@item.item_ext.publish_info</b>
							</p>
							@if (!string.IsNullOrEmpty(item.item_ext?.summary))
							{
								<p class="truncate-3-lines">
									<span style="font-weight:600">Tóm tắt:</span> @item.item_ext.summary
								</p>
							}
						</div>

						<div>
							<button class="library-container__btn-book-detail-book">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M568.482 177.448L424.479 313.433C409.3 327.768 384 317.14 384 295.985v-71.963c-144.575.97-205.566 35.113-164.775 171.353 4.483 14.973-12.846 26.567-25.006 17.33C155.252 383.105 120 326.488 120 269.339c0-143.937 117.599-172.5 264-173.312V24.012c0-21.174 25.317-31.768 40.479-17.448l144.003 135.988c10.02 9.463 10.028 25.425 0 34.896zM384 379.128V448H64V128h50.916a11.99 11.99 0 0 0 8.648-3.693c14.953-15.568 32.237-27.89 51.014-37.676C185.708 80.83 181.584 64 169.033 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48v-88.806c0-8.288-8.197-14.066-16.011-11.302a71.83 71.83 0 0 1-34.189 3.377c-7.27-1.046-13.8 4.514-13.8 11.859z" /></svg>
								<span>Muợn sách</span>
							</button>
							<button class="library-container__btn-book-detail-book-white mt-1">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z" /></svg>
								<span>Yêu thích</span>
							</button>
						</div>
					</div>

				}
			</div>
		</div>
	</div>
	<div class="library-container__suggested-books documentDetail__recommend">
		<h3>Có thể bạn sẽ thích</h3>
		<ul>
				@foreach (var item in Model.HotDocuments)
				{
				<li>
					<a onclick="window.open('@ConstLocation.value/chi-tiet-tai-lieu/@item.slug','_blank')" style="cursor:grabbing">@item.title</a>
				</li>
				}
		</ul>
	</div>
</div>

@* <div class="library-container__content-row">
	<div class="second-content__library-container">
		<label class="library-container__title">
			Danh sách thư viện lưu trữ
			<span class="library-container__line"></span>
		</label>
		<div class="library-layout-two-columns">
			<!-- Cột trái: Danh sách thư viện -->
			<div class="library-container__library-list">
				@foreach (var item in Model)
				{
					<div class="library-card @(item.IsAvailable ? "available" : "unavailable")">
						@if (!item.IsAvailable)
						{
							<div class="overlay">
								<div class="out-of-stock">
									<h4>SÁCH ĐÃ HẾT.</h4>
									<p>Chúng tôi sẽ thông báo khi có bản mới!</p>
									<button class="notify-button">Nhận thông báo</button>
								</div>
							</div>
						}

						<div class="library-card__left">
							<img src="@item.ImageUrl" alt="@item.AltText" asp-append-version="true" />
						</div>

						<div class="library-card__right">
							<div class="library-info">
								<h3 class="library-name @(item.IsAvailable ? "" : "text-muted")">@item.Name</h3>
								<p class="library-en">@item.EnglishName</p>
								@if (!string.IsNullOrEmpty(item.Distance))
								{
									<p class="library-distance">
										<span class="icon">@Html.MapSvg(false)</span>
										<label><span class="distance-text">@item.Distance</span> từ vị trí của bạn</label>
									</p>
								}
								<p class="library-address">@item.Address</p>
							</div>

							<div class="library-actions">
								<button class="btn primary" @(item.IsAvailable ? "" : "disabled")>
									@Html.BorrowSvg(false)Mượn
									sách
								</button>
								<a class="btn secondary" @(item.IsAvailable ? "" : "disabled")>
									@Html.StarSvg(false)Thư
									viện yêu
									thích
								</a>
							</div>
						</div>
					</div>
				}
			</div>
		</div>
	</div>
	<div class="library-container__suggested-books">
		<h3>Có thể bạn sẽ thích</h3>
		<ul class="skeleton-list">
			<li><a href="#"></a></li>
			<li><a href="#"></a></li>
			<li><a href="#"></a></li>
			<li><a href="#"></a></li>
			<li><a href="#"></a></li>
		</ul>
	</div>
</div> *@